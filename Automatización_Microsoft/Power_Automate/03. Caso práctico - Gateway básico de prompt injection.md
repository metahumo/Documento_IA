
---

# ValidaciÃ³n de correos para automatizaciones â€” DocumentaciÃ³n tÃ©cnica


## IntroducciÃ³n

Esta herramienta es una capa de prefiltrado y normalizaciÃ³n determinista, diseÃ±ada para reducir superficies de ataque antes de que cualquier automatizaciÃ³n con IA procese correos.

No pretendemos detectar todas las variantes posibles de prompt injection; su objetivo es proporcionar una puerta de entrada segura que limite y controle quÃ© correos pueden ser procesados por sistemas con IA, reduciendo significativamente el riesgo antes de introducir inteligencia artificial.

---

## Contexto y objetivo del flujo

Se ha desarrollado una automatizaciÃ³n que:

- Supervisa la bandeja de entrada (Inbox).
    
- Analiza el contenido de cada correo entrante.
    
- Identifica patrones tÃ­picos de prompt injection mediante reglas deterministas aplicando heurÃ­stica.
    
- ActÃºa automÃ¡ticamente (mover, registrar, alertar) segÃºn niveles de riesgo.
    

El flujo no utiliza modelos de IA: utiliza normalizaciÃ³n y reglas explÃ­citas (contains, arrays de indicadores, puntuaciÃ³n) para maximizar explicabilidad y trazabilidad.

---

## ConfiguraciÃ³n previa

Antes de construir el flujo es necesario preparar tres elementos fundamentales. 

### A) Biblioteca segura en SharePoint

Creamos un espacio controlado donde almacenar correos y evidencias:

1. Accedemos al sitio de SharePoint â†’ _Contenido del sitio_.
    
2. Creamos una **Biblioteca de documentos** llamada:
    
    - `Seguridad-Correos`
        
3. Dentro de la biblioteca creamos la carpeta:
    
    - `Cuarentena`
        
4. Ajustamos permisos dejando acceso Ãºnicamente a:
    
    - El propietario del flujo.
        
    - El equipo de seguridad (si existe).
        
5. Dentro de `Cuarentena` creamos la subcarpeta:
    
    - `Adjuntos`
        

Estructura final:

```
Seguridad-Correos/
â””â”€â”€ Cuarentena/
    â””â”€â”€ Adjuntos/
```

Este diseÃ±o garantiza confidencialidad, control de acceso y segregaciÃ³n de evidencias.

---

### B) Lista de registro de incidentes

Creamos una lista para mantener trazabilidad y auditorÃ­a:

1. SharePoint â†’ _Nuevo_ â†’ _Lista_.
    
2. Nombre de la lista:
    
    - `Incidentes-PromptInjection`
        
3. Columnas definidas:
    
    - **Titulo** (Texto)
        
    - **Remitente** (Texto)
        
    - **Asunto** (Texto)
        
    - **FechaRecepcion** (Fecha y hora)
        
    - **EnlaceCorreo** (HipervÃ­nculo)
        
    - **Notas** (Texto multilÃ­nea)
        
    - **Identificador del mensaje** (Texto)
        
    - **Score final** (Texto)
        

Esta lista permite centralizar incidentes y facilitar anÃ¡lisis posteriores.

---

### C) Carpeta de cuarentena en Outlook

1. En Outlook, sobre _Bandeja de entrada_ â†’ _Nueva carpeta_.
    
2. Nombre:
    
    - `Cuarentena-Seguridad`
        

AquÃ­ se moverÃ¡n automÃ¡ticamente los correos considerados sospechosos.

---


## Resumen tÃ©cnico del flujo

**Trigger**: Cuando llega un nuevo correo electrÃ³nico (V3) â€” carpeta: `Inbox`.

**Variables iniciales**:

- `score_riesgo` (integer) = 0
    
- `score_array` (array) = []
    
- `score_final` (integer) = 0 (se calcula al final)
    

**Pasos principales**:

1. Convertir el cuerpo HTML del correo a texto plano (acciÃ³n `Html_a_texto`).
    
2. Normalizar el texto a minÃºsculas (acciÃ³n `Redactar` = `toLower(...)`).
    
3. Buscar indicadores en varias categorÃ­as y agregar puntuaciones a `score_array`:
    
    - SeÃ±ales contextuales: cada coincidencia suma `1`.
        
    - SeÃ±ales estructurales: cada coincidencia suma `3`.
        
    - SeÃ±ales intencionales: cada coincidencia suma `5`.
        
    - SeÃ±ales de ofuscaciÃ³n: cada coincidencia suma `25`.
        
4. Comprobar dominio corporativo (`@dominio.com`) y, si coincide, aÃ±adir `-1` (reducciÃ³n de puntaje por confianza de remitente).
    
5. Iterar `score_array` y sumar sus valores en `score_riesgo`.
    
6. Establecer `score_final = score_riesgo`.
    
7. Evaluar niveles de riesgo:
    
    - **Riesgo bajo**: `score_final <= 10` â†’ no acciÃ³n (flujo finaliza).
        
    - **Riesgo medio**: `11 <= score_final <= 24` â†’ enviar alerta por correo, crear archivo con evidencia en SharePoint y registrar elemento en lista.
        
    - **Riesgo crÃ­tico**: `score_final >= 25` â†’ mover correo a carpeta `Cuarentena-Seguridad`, crear archivo con evidencia en SharePoint, registrar elemento en lista y notificar por correo.
        
8. Finalizar el flujo (`Terminate` con Ã©xito).
    

---

## Mapeo de acciones (detallado)

A continuaciÃ³n describimos cada acciÃ³n, su propÃ³sito y detalles tÃ©cnicos extraÃ­dos del flujo.

### TRIGGER: Cuando llega un nuevo correo electrÃ³nico (V3)

**AcciÃ³n:** Office 365 Outlook â†’ Cuando llega un nuevo correo electrÃ³nico (V3)

**ConfiguraciÃ³n:**
- **Carpeta:** `Inbox`
- **Incluir datos adjuntos:** `SÃ­` (true)
- **Importancia:** `Cualquiera`
- **Solo con datos adjuntos:** `No` (false)
- **Split On/Dividir:** `@triggerOutputs()?['body/value']` âœ… ACTIVADO


---

### PASO 1: Inicializar variable score_riesgo

**AcciÃ³n:** Variables â†’ Inicializar variable

**Nombre de acciÃ³n:** `Inicializar_variable_score_riesgo`

**ConfiguraciÃ³n:**
- **Nombre:** `score_riesgo`
- **Tipo:** `Integer`
- **Valor:** `0`

**Ejecutar despuÃ©s de:** (ninguno - es el primer paso)


---

### PASO 2: Inicializar variable score_array

**AcciÃ³n:** Variables â†’ Inicializar variable

**Nombre de acciÃ³n:** `Inicializar_variable_score_array`

**ConfiguraciÃ³n:**
- **Nombre:** `score_array`
- **Tipo:** `Array`
- **Valor:** `[]` (array vacÃ­o)

**Ejecutar despuÃ©s de:** `Inicializar_variable_score_riesgo` [Succeeded]


---

### PASO 3: Html a texto

**AcciÃ³n:** Conversion Service â†’ Html a texto

**Nombre de acciÃ³n:** `Html_a_texto`

**ConfiguraciÃ³n:**
- **Contenido:** dinÃ¡mico (Cuerpo)
```
triggerOutputs()?['body/body']
```

**Ejecutar despuÃ©s de:** `Inicializar_variable_score_array` [Succeeded]


---

### PASO 4: Redactar

**AcciÃ³n:** Operaciones de datos â†’ Redactar

**Nombre de acciÃ³n:** `Redactar`

**ConfiguraciÃ³n:**
- **Entradas:** 
```
toLower(body('Html_a_texto'))
```

**Ejecutar despuÃ©s de:** `Html_a_texto` [Succeeded]

**DescripciÃ³n:** Convierte el contenido del correo a minÃºsculas para facilitar la bÃºsqueda de patrones sin importar mayÃºsculas/minÃºsculas.


---

### PASO 5: Aplicar a cada uno - SEÃ‘ALES CONTEXTUALES

**AcciÃ³n:** Control â†’ Aplicar a cada uno

**Nombre de acciÃ³n:** `SeÃ±ales_contextuales`

**ConfiguraciÃ³n:**
- **Aplicar a cada uno:** 
```
createArray('asistente inteligente','inteligencia artificial','api','password','contraseÃ±a')
```

**Ejecutar despuÃ©s de:** `Redactar` [Succeeded]


**Dentro del bucle:**

#### CondiciÃ³n: Verificar presencia contexto

**Tipo:** Control â†’ CondiciÃ³n

**ExpresiÃ³n de la condiciÃ³n:**
```json
contains(outputs('Redactar'), items('SeÃ±ales_contextuales'))
```

**Rama SI (True):**

##### Anexar a la variable de matriz +1

**AcciÃ³n:** Variables â†’ Anexar a la variable de matriz

**Nombre:** `Anexar_a_la_variable_de_matriz_+1`

**ConfiguraciÃ³n:**
- **Nombre:** `score_array`
- **Valor:** `1`

**Rama NO (False):** VacÃ­a


---

### PASO 6: Aplicar a cada uno - SEÃ‘ALES ESTRUCTURALES

**AcciÃ³n:** Control â†’ Aplicar a cada uno

**Nombre de acciÃ³n:** `SeÃ±ales_estructurales`

**ConfiguraciÃ³n:**
- **Aplicar a cada uno:** 
```
createArray('paso 1','salida:','instrucciones a seguir')
```

**Ejecutar despuÃ©s de:** `SeÃ±ales_contextuales` [Succeeded]


**Dentro del bucle:**

#### CondiciÃ³n: Verificar presencia estructural

**Tipo:** Control â†’ CondiciÃ³n

**ExpresiÃ³n de la condiciÃ³n:**
```json
contains(outputs('Redactar'), items('SeÃ±ales_estructurales'))
```

**Rama SI (True):**

##### Anexar a la variable de matriz +3

**AcciÃ³n:** Variables â†’ Anexar a la variable de matriz

**Nombre:** `Anexar_a_la_variable_de_matriz_+3`

**ConfiguraciÃ³n:**
- **Nombre:** `score_array`
- **Valor:** `3`

**Rama NO (False):** VacÃ­a


---

### PASO 7: Aplicar a cada uno - SEÃ‘ALES INTENCIONALES

**AcciÃ³n:** Control â†’ Aplicar a cada uno

**Nombre de acciÃ³n:** `SeÃ±ales_intencionales`

**ConfiguraciÃ³n:**
- **Aplicar a cada uno:** 
```
createArray('ignora las instrucciones','omite reglas','actÃºa como un experto','comportate como administrador','asume el rol','no informes de')
```

**Ejecutar despuÃ©s de:** `SeÃ±ales_estructurales` [Succeeded]


**Dentro del bucle:**

#### CondiciÃ³n: Verificar_presencia_intencional

**Tipo:** Control â†’ CondiciÃ³n

**ExpresiÃ³n de la condiciÃ³n:**
```json
contains(outputs('Redactar'), items('SeÃ±ales_intencionales'))
```

**Rama SI (True):**

##### Anexar a la variable de matriz +5

**AcciÃ³n:** Variables â†’ Anexar a la variable de matriz

**Nombre:** `Anexar_a_la_variable_de_matriz_+5`

**ConfiguraciÃ³n:**
- **Nombre:** `score_array`
- **Valor:** `5`


**Rama NO (False):** VacÃ­a

---

### PASO 8: Aplicar a cada uno - SEÃ‘ALES OFUSCACIÃ“N

**AcciÃ³n:** Control â†’ Aplicar a cada uno

**Nombre de acciÃ³n:** `SeÃ±ales_ofuscaciÃ³n`

**ConfiguraciÃ³n:**
- **Aplicar a cada uno:** 
```
createArray('i.g.n.o.r.a','i g n o r a','e j e c u t a','e.j.e.c.u.t.a')
```

**Ejecutar despuÃ©s de:** `SeÃ±ales_intencionales` [Succeeded]


**Dentro del bucle:**

#### CondiciÃ³n: Verificar_presencia_ofuscaciÃ³n

**Tipo:** Control â†’ CondiciÃ³n

**ExpresiÃ³n de la condiciÃ³n:**
```json
contains(outputs('Redactar'), items('SeÃ±ales_ofuscaciÃ³n'))
```

**Rama SI (True):**

##### Anexar a la variable de matriz +25

**AcciÃ³n:** Variables â†’ Anexar a la variable de matriz

**Nombre:** `Anexar_a_la_variable_de_matriz_+25`

**ConfiguraciÃ³n:**
- **Nombre:** `score_array`
- **Valor:** `25`


**Rama NO (False):** VacÃ­a

---

### PASO 9: CondiciÃ³n - DOMINIO CORPORATIVO

**AcciÃ³n:** Control â†’ CondiciÃ³n

**Nombre de acciÃ³n:** `Dominio_corporativo`

**ExpresiÃ³n de la condiciÃ³n:**
```json
contains(coalesce(triggerOutputs()?['body/from/emailAddress/address'], ''), '@dominio.com')
```

**Ejecutar despuÃ©s de:** `SeÃ±ales_ofuscaciÃ³n` [Succeeded]


**Rama SI (True):**

##### Anexar a la variable de matriz -1

**AcciÃ³n:** Variables â†’ Anexar a la variable de matriz

**Nombre:** `Anexar_a_la_variable_de_matriz_-1`

**ConfiguraciÃ³n:**
- **Nombre:** `score_array`
- **Valor:** `-1`


**DescripciÃ³n:** Resta 1 punto si el correo proviene del dominio corporativo `@dominio.com`.

**Rama NO (False):** VacÃ­a

---

### PASO 10: Aplicar a cada uno - SUMAR SCORES

**AcciÃ³n:** Control â†’ Aplicar a cada uno

**Nombre de acciÃ³n:** `Aplicar_a_cada_uno`

**ConfiguraciÃ³n:**
- **Aplicar a cada uno:** dinÃ¡mico (score array)
```
variables('score_array')
```

**Ejecutar despuÃ©s de:** `Dominio_corporativo` [Succeeded]


**Dentro del bucle:**

#### Incrementar variable

**AcciÃ³n:** Variables â†’ Incrementar variable

**Nombre:** `Incrementar_variable`

**ConfiguraciÃ³n:**
- **Nombre:** `score_riesgo`
- **Valor:** 
```
items('Aplicar_a_cada_uno')
```


**DescripciÃ³n:** Suma todos los valores del array `score_array` a la variable `score_riesgo`.

---

### PASO 11: Inicializar variable score_final

**AcciÃ³n:** Variables â†’ Inicializar variable

**Nombre de acciÃ³n:** `Inicializar_variable_score_final`

**ConfiguraciÃ³n:**
- **Nombre:** `score_final`
- **Tipo:** `Integer`
- **Valor:** `0`

**Ejecutar despuÃ©s de:** `Aplicar_a_cada_uno` [Succeeded]


---

### PASO 12: Establecer variable score_final

**AcciÃ³n:** Variables â†’ Establecer variable

**Nombre de acciÃ³n:** `Establecer_variable_score_final`

**ConfiguraciÃ³n:**
- **Nombre:** `score_final`
- **Valor:** 
```
variables('score_riesgo')
```

**Ejecutar despuÃ©s de:** `Inicializar_variable_score_final` [Succeeded]


**DescripciÃ³n:** Copia el valor de `score_riesgo` a `score_final` para usarlo en las condiciones de riesgo.

---

### PASO 13: CondiciÃ³n riesgo BAJO

**AcciÃ³n:** Control â†’ CondiciÃ³n

**Nombre de acciÃ³n:** `CondiciÃ³n_riesgo_bajo`

**ExpresiÃ³n de la condiciÃ³n:**
```json
lessOrEquals(variables('score_final'), 10)
```

**Ejecutar despuÃ©s de:** `Establecer_variable_score_final` [Succeeded]


**Rama SI (True):** VacÃ­a (no se realiza ninguna acciÃ³n)

**Rama NO (False):** VacÃ­a

**DescripciÃ³n:** Si el score es â‰¤ 10, se considera riesgo bajo y no se toma ninguna acciÃ³n.


---

### PASO 14: CondiciÃ³n riesgo MEDIO

**AcciÃ³n:** Control â†’ CondiciÃ³n

**Nombre de acciÃ³n:** `CondiciÃ³n_riesgo_medio`

**ExpresiÃ³n de la condiciÃ³n:**
```json
and( greaterOrEquals(variables('score_final'), 11), lessOrEquals(variables('score_final'), 24) )
```

**Ejecutar despuÃ©s de:** `Establecer_variable_score_final` [Succeeded]


**Rama SI (True):**

#### 14.1: Enviar correo electrÃ³nico (V2)

**AcciÃ³n:** Office 365 Outlook â†’ Enviar correo electrÃ³nico (V2)

**Nombre:** `Enviar_correo_electrÃ³nico_(V2)`

**ConfiguraciÃ³n:**
- **Para:** `admin@dominio.com`
- **Asunto:** `[ALERTA MEDIA] Correo sospechoso - Requiere validaciÃ³n`
- **Cuerpo:**
```html
Estimado/a usuario/a:

Se ha detectado un correo electrÃ³nico con nivel de riesgo MEDIO que requiere su revisiÃ³n.

Detalles del correo:

Asunto: @{triggerOutputs()?['body/subject']}
Remitente: @{triggerOutputs()?['body/from']}
Fecha de recepciÃ³n: @{triggerOutputs()?['body/receivedDateTime']}
ID del mensaje: @{triggerOutputs()?['body/id']}

Â¿QuÃ© debe hacer?
Revise el contenido del correo para determinar si es legÃ­timo o sospechoso

Si considera que es malintencionado:
- Mueva el correo a la carpeta "Cuarentena-Seguridad"
- Notifique al equipo de seguridad respondiendo a este correo o contactando al responsable


Si el correo es legÃ­timo:
- No es necesario realizar ninguna acciÃ³n adicional


SeÃ±ales de alerta detectadas:
El sistema ha identificado patrones que podrÃ­an indicar un intento de manipulaciÃ³n o ataque. Su criterio como usuario es fundamental para validar esta alerta.

Gracias por su colaboraciÃ³n en mantener la seguridad de nuestra organizaciÃ³n.

Equipo de Seguridad de la InformaciÃ³n


```
- **Importancia:** `High`


---

#### 14.2: Crear archivo

**AcciÃ³n:** SharePoint â†’ Crear archivo

**Nombre:** `Crear archivo SharePoint medio`

**ConfiguraciÃ³n:**
- **DirecciÃ³n del sitio:** `https://empresa.sharepoint.com/sites/sitio-seguridad`
- **Ruta de carpeta:** `/SeguridadCorreos/Cuarentena/Adjuntos`
- **Nombre de archivo:**
```
concat(formatDateTime(utcNow(),'yyyy-MM-ddTHH-mm-ssZ'),'-ID:',guid(),'.txt')
```
- **Contenido del archivo:**
```
RIESGO MEDIO
Remitente: @{triggerOutputs()?['body/from']} 
Fecha y hora: @{triggerOutputs()?['body/receivedDateTime']} 
Asunto: @{triggerOutputs()?['body/subject']} 
Mensaje: @{body('Html_a_texto')}

```

**Ejecutar despuÃ©s de:** `Enviar_correo_electrÃ³nico_(V2)` [Succeeded]


---

#### 14.3: Crear elemento

**AcciÃ³n:** SharePoint â†’ Crear elemento

**Nombre:** `Crear elemento lista medio`

**ConfiguraciÃ³n:**
- **DirecciÃ³n del sitio:** `https://empresa.sharepoint.com/sites/sitio-seguridad`
- **Nombre de lista (ID):** `Incidencias-Prompt_Injection`
- **Title:** dinÃ¡mico (De)
```
triggerOutputs()?['body/from']
```
- **Titulo:** `Riesgo Medio `
- **Asunto:** DinÃ¡mico (Asunto)
```
triggerOutputs()?['body/subject']
```
- **Fecha_RecepciÃ³n:** DinÃ¡mico (Fecha y hora recepciÃ³n)
```
triggerOutputs()?['body/receivedDateTime']
```
- **Enlace_Correo:** `https://empresa.sharepoint.com/sites/sitio-seguridad/SeguridadCorreos/Cuarentena/Adjuntos`
- **Notas:** `Contenido etiquetado como medio`
- **Identificadordelmensaje:** DinÃ¡mico (Id de mensaje)
```
triggerOutputs()?['body/id']
```
- **Scorefinal:** DinÃ¡mico (score_final)
```
variables('score_final')
```
- **ContentType Id:** `Elemento`

**Ejecutar despuÃ©s de:** `Crear_archivo_1` [Succeeded]

**Rama NO (False):** VacÃ­a


---

### PASO 15: CondiciÃ³n riesgo CRÃTICO

**AcciÃ³n:** Control â†’ CondiciÃ³n

**Nombre de acciÃ³n:** `CondiciÃ³n_riesgo_crÃ­tico`

**ExpresiÃ³n de la condiciÃ³n:**
```json
greaterOrEquals(variables('score_final'), 25)
```

**Ejecutar despuÃ©s de:** `Establecer_variable_score_final` [Succeeded]

**Rama SI (True):**

#### 15.1: Mover correo electrÃ³nico (V2)

**AcciÃ³n:** Office 365 Outlook â†’ Mover correo electrÃ³nico (V2)

**Nombre:** `Mover_correo_electrÃ³nico_(V2)`

**ConfiguraciÃ³n:**
- **Id. de mensaje:** DinÃ¡mico (Id del mensaje)
```
triggerOutputs()?['body/id']
```
- **Carpeta:** `Cuarentena-Seguridad`


---

#### 15.2: Crear archivo

**AcciÃ³n:** SharePoint â†’ Crear archivo

**Nombre:** `Crear archivo SharePoint crÃ­tico`

**ConfiguraciÃ³n:**
- **DirecciÃ³n del sitio:** `https://empresa.sharepoint.com/sites/sitio-seguridad`
- **Ruta de carpeta:** `/SeguridadCorreos/Cuarentena/Adjuntos`
- **Nombre de archivo:**
```
concat(formatDateTime(utcNow(),'yyyy-MM-ddTHH-mm-ssZ'),'-ID:',guid(),'.txt')
```
- **Contenido del archivo:**
```
RIESGO CRÃTICO

Remitente: @{triggerOutputs()?['body/from']} 
Fecha y hora: @{triggerOutputs()?['body/receivedDateTime']} 
Asunto: @{triggerOutputs()?['body/subject']} 
Mensaje: @{body('Html_a_texto')}


```

**Ejecutar despuÃ©s de:** `Mover_correo_electrÃ³nico_(V2)` [Succeeded]

#### 15.3: Crear elemento

**AcciÃ³n:** SharePoint â†’ Crear elemento

**Nombre:** `Crear elemento lista crÃ­tico`

**ConfiguraciÃ³n:**
- **DirecciÃ³n del sitio:** `https://empresa.sharepoint.com/sites/sitio-seguridad`
- **Nombre de lista (ID):** `Incidencias-Prompt_Injection`
- **Title:** DinÃ¡mico
```
@triggerOutputs()?['body/from']
```
- **Titulo:** `Riesgo CrÃ­tico `
- **Asunto:** DinÃ¡mico
```
@triggerOutputs()?['body/subject']
```
- **Fecha_RecepciÃ³n:** DinÃ¡mico
```
@triggerOutputs()?['body/receivedDateTime']
```
- **Enlace_Correo:** `https://empresa.sharepoint.com/sites/sitio-seguridad/SeguridadCorreos/Cuarentena/Adjuntos`
- **Notas:** `Contenido etiquetado como crÃ­tico`
- **Identificadordelmensaje:** DinÃ¡mico
```
@triggerOutputs()?['body/id']
```
- **Scorefinal:** DinÃ¡mico
```
@variables('score_final')
```
- **ContentType Id:** `Elemento`

**Ejecutar despuÃ©s de:** `Crear_archivo` [Succeeded]


---

#### 15.4: Enviar correo electrÃ³nico (V2)

**AcciÃ³n:** Office 365 Outlook â†’ Enviar correo electrÃ³nico (V2)

**Nombre:** `Enviar_correo_electrÃ³nico_(V2)_1`

**ConfiguraciÃ³n:**
- **Para:** `admin@dominio.com`
- **Asunto:** `[ALERTA CRÃTICA] Correo en cuarentena - RevisiÃ³n requerida`
- **Cuerpo:**
```html
Estimado/a usuario/a:

Se ha detectado un correo electrÃ³nico con nivel de riesgo CRÃTICO en su bandeja de entrada.

AcciÃ³n tomada:
El correo ha sido movido automÃ¡ticamente a la carpeta "Cuarentena-Seguridad" como medida preventiva para proteger los sistemas de automatizaciÃ³n con IA de posibles amenazas.

Â¿QuÃ© debe hacer?
Por favor, revise el correo en cuarentena para verificar si es legÃ­timo o si se trata de una amenaza real. Esto nos ayudarÃ¡ a:

- Evitar la pÃ©rdida de informaciÃ³n importante
- Confirmar la efectividad del sistema de seguridad
- Mejorar la detecciÃ³n de amenazas


No requiere acciones adicionales:
El sistema ya ha generado el reporte correspondiente y registrado el incidente automÃ¡ticamente.

Detalles del correo:

Remitente: @{triggerOutputs()?['body/from']}
Asunto: @{triggerOutputs()?['body/subject']}
Fecha: @{triggerOutputs()?['body/receivedDateTime']}
UbicaciÃ³n: Carpeta "Cuarentena-Seguridad"

Gracias por su colaboraciÃ³n en mantener un entorno de trabajo seguro.

Equipo de Seguridad de la InformaciÃ³n

```
- **Importancia:** `High`

**Ejecutar despuÃ©s de:** `Crear_elemento` [Succeeded]

**Rama NO (False):** VacÃ­a

---

### PASO 16: FINALIZAR

**AcciÃ³n:** Control â†’ Finalizar

**Nombre de la acciÃ³n:** `Finalizar`

**ConfiguraciÃ³n:**
- **Estado:** `Succeeded`

**Ejecutar despuÃ©s de:** 
- `CondiciÃ³n_riesgo_bajo` [Succeeded, Skipped]
- `CondiciÃ³n_riesgo_medio` [Succeeded, Skipped]
- `CondiciÃ³n_riesgo_crÃ­tico` [Succeeded, Skipped]


**DescripciÃ³n:** Finaliza el flujo con estado exitoso despuÃ©s de que cualquiera de las tres condiciones de riesgo se haya ejecutado u omitido.

---

## Flujo visual (detallado)

A continuaciÃ³n presentamos un diagrama paso a paso en texto y un esquema lÃ³gico que nos permite entender claramente cÃ³mo circula el flujo.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRIGGER: Cuando llega un nuevo correo electrÃ³nico (V3)          â”‚
â”‚ Folder: Inbox | Include Attachments: Yes | Split On: Enabled    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Inicializar variable: score_riesgo                           â”‚
â”‚    Type: Integer | Value: 0                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Inicializar variable: score_array                            â”‚
â”‚    Type: Array | Value: []                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Html a texto                                                 â”‚
â”‚    Content: <p class="editor-paragraph">                        â”‚
â”‚             @{triggerOutputs()?['body/body']}</p>               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Redactar (Compose)                                           â”‚
â”‚    Inputs: @toLower(body('Html_a_texto'))                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Aplicar a cada uno - SEÃ‘ALES CONTEXTUALES                    â”‚
â”‚    Aplicar a cada uno items: createArray(                       â”‚
â”‚       'asistente inteligente',                                  â”‚
â”‚       'inteligencia artificial',                                â”‚
â”‚       'api',                                                    â”‚
â”‚       'password',                                               â”‚
â”‚       'contraseÃ±a')                                             â”‚
â”‚    â”œâ”€ CondiciÃ³n: Verificar_presencia_contexto                   â”‚
â”‚    â”‚  contains(outputs('Redactar'),                             â”‚
â”‚    â”‚           items('SeÃ±ales_contextuales')) == true           â”‚
â”‚    â”‚  â””â”€ SI: Anexar a score_array: 1                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Aplicar a cada uno - SEÃ‘ALES ESTRUCTURALES                   â”‚
â”‚    Aplicar a cada uno items: createArray(                       â”‚
â”‚       'paso 1',                                                 â”‚
â”‚       'salida:',                                                â”‚
â”‚       'instrucciones a seguir')                                 â”‚
â”‚    â”œâ”€ CondiciÃ³n: Verificar_presencia_estructural                â”‚
â”‚    â”‚  contains(outputs('Redactar'),                             â”‚
â”‚    â”‚           items('SeÃ±ales_estructurales')) == true          â”‚
â”‚    â”‚  â””â”€ SI: Anexar a score_array: 3                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Aplicar a cada uno - SEÃ‘ALES INTENCIONALES                   â”‚
â”‚    Aplicar a cada uno items: createArray(                       â”‚
â”‚       'ignora las instrucciones',                               â”‚
â”‚       'omite reglas',                                           â”‚
â”‚       'actÃºa como un experto',                                  â”‚
â”‚       'comportate como administrador',                          â”‚
â”‚       'asume el rol',                                           â”‚
â”‚       'no informes de')                                         â”‚
â”‚    â”œâ”€ CondiciÃ³n: Verificar_presencia_intencional                â”‚
â”‚    â”‚  contains(outputs('Redactar'),                             â”‚
â”‚    â”‚           items('SeÃ±ales_intencionales')) == true          â”‚
â”‚    â”‚  â””â”€ SI: Anexar a score_array: 5                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Aplicar a cada uno - SEÃ‘ALES OFUSCACIÃ“N                      â”‚
â”‚    Aplicar a cada uno items: createArray(                       â”‚
â”‚       'i.g.n.o.r.a',                                            â”‚
â”‚       'i g n o r a',                                            â”‚
â”‚       'e j e c u t a',                                          â”‚
â”‚       'e.j.e.c.u.t.a')                                          â”‚
â”‚    â”œâ”€ CondiciÃ³n: Verificar_presencia_ofuscaciÃ³n                 â”‚
â”‚    â”‚  contains(outputs('Redactar'),                             â”‚
â”‚    â”‚           items('SeÃ±ales_ofuscaciÃ³n')) == true             â”‚
â”‚    â”‚  â””â”€ SI: Anexar a score_array: 25                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. CondiciÃ³n - DOMINIO CORPORATIVO                              â”‚
â”‚    Expression: contains(                                        â”‚
â”‚       coalesce(triggerOutputs()?                                â”‚
â”‚         ['body/from/emailAddress/address'], ''),                â”‚
â”‚       '@dominio.com') == true                                   â”‚
â”‚    â””â”€ SI: Anexar a score_array: -1                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. Aplicar a cada uno - SUMAR SCORES                           â”‚
â”‚     Aplicar a cada uno: @variables('score_array')               â”‚
â”‚     â””â”€ Incrementar variable score_riesgo:                       â”‚
â”‚        items('Aplicar_a_cada_uno')                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11. Inicializar variable: score_final                           â”‚
â”‚     Type: Integer | Value: 0                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 12. Establecer variable: score_final                            â”‚
â”‚     Value: @variables('score_riesgo')                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                         â–¼              â–¼              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ BAJA 13      â”‚ â”‚ MEDIA 15     â”‚ â”‚ CRÃTICA 14   â”‚
              â”‚ score <= 10  â”‚ â”‚ 11-24        â”‚ â”‚ score >= 25  â”‚
              â”‚ (No Action)  â”‚ â”‚ (Action)     â”‚ â”‚ (Action)     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚              â”‚              â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ FINALIZAR (Succeeded)    â”‚
                         â”‚ Run after: 13, 14, 15    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## RESUMEN DE PATRONES DETECTADOS Y PUNTAJES

| **CategorÃ­a** | **PatrÃ³n** | **Puntos** |
|---------------|------------|------------|
| **SeÃ±ales Contextuales** | asistente inteligente | +1 |
| | inteligencia artificial | +1 |
| | api | +1 |
| | password | +1 |
| | contraseÃ±a | +1 |
| **SeÃ±ales Estructurales** | paso 1 | +3 |
| | salida: | +3 |
| | instrucciones a seguir | +3 |
| **SeÃ±ales Intencionales** | ignora las instrucciones | +5 |
| | omite reglas | +5 |
| | actÃºa como un experto | +5 |
| | comportate como administrador | +5 |
| | asume el rol | +5 |
| | no informes de | +5 |
| **SeÃ±ales OfuscaciÃ³n** | i.g.n.o.r.a | +25 |
| | i g n o r a | +25 |
| | e j e c u t a | +25 |
| | e.j.e.c.u.t.a | +25 |
| **Dominio Corporativo** | @dominio.com | -1 |

---

## NIVELES DE RIESGO Y ACCIONES

### ğŸŸ¢ RIESGO BAJO (Score â‰¤ 10)
**AcciÃ³n:** Ninguna  
**DescripciÃ³n:** El correo se considera seguro y permanece en la bandeja de entrada del usuario.

---

### ğŸŸ¡ RIESGO MEDIO (Score 11-24)
**Acciones:**
1. âœ‰ï¸ Enviar alerta por correo electrÃ³nico (Importancia: High)
2. ğŸ“„ Crear archivo de registro en SharePoint
3. ğŸ“ Crear elemento en lista de SharePoint con:
   - TÃ­tulo: Riesgo Medio
   - Remitente, asunto, fecha
   - Score final
   - Enlace al archivo

**DescripciÃ³n:** Se notifica al usuario para que revise manualmente el correo. El correo NO se mueve automÃ¡ticamente.

---

### ğŸ”´ RIESGO CRÃTICO (Score â‰¥ 25)
**Acciones:**
1. ğŸ“§ Mover correo a "Cuarentena-Seguridad"
2. ğŸ“„ Crear archivo de registro en SharePoint (etiquetado como RIESGO CRÃTICO)
3. ğŸ“ Crear elemento en lista de SharePoint con:
   - TÃ­tulo: Riesgo CrÃ­tico
   - Remitente, asunto, fecha
   - Score final
   - Enlace al archivo
4. âœ‰ï¸ Enviar alerta por correo electrÃ³nico (Importancia: High)

**DescripciÃ³n:** El correo se mueve automÃ¡ticamente a cuarentena y se notifica al responsable de seguridad.

---

## Razonamiento sobre diseÃ±o y umbrales

- **NormalizaciÃ³n**: usar `toLower()` y `HtmlToText` reduce falsos negativos por formato y capitalizaciÃ³n.
    
- **BÃºsqueda por coincidencia simple** (`contains`) es rÃ¡pida, explicable y suficiente como primera barrera; no requiere modelos ML ni uso de IA (esto Ãºltimo para evitar vector de ataque).
    
- **Puntuaciones por categorÃ­a**: asignamos distintos pesos segÃºn gravedad aparente. La ofuscaciÃ³n obtiene penalizaciÃ³n alta (25) porque suele indicar intenciÃ³n deliberada de evadir detecciÃ³n.
    
- **Dominio corporativo**: resta 1 punto para reducir falsos positivos de comunicaciones internas.
    
- **Umbrales**: elegimos 10/11-24/25+ para mantener un margen que permita seÃ±ales triviales sin bloquear correos legÃ­timos. (Se recomienda ajustar en base a la experiencia acumulada)
    

## Riesgos, limitaciones y falsos positivos

- Coincidencias parciales o contexto no malicioso pueden sumar puntos (p. ej. manuales tÃ©cnicos que mencionen "password").
    
- Listas estÃ¡ticas de palabras quedan obsoletas; requieren mantenimiento.
    
- El mÃ©todo no detecta ataques lÃ³gicos complejos ni prompt injections semÃ¡nticas extendidas.
    
- Correos con contenido en imÃ¡genes o adjuntos maliciosos no son analizados por las reglas de texto (se requiere un escaneo adicional).
    
- La herramienta no decodifica ni interpreta contenido en base64 o hexadecimal. Este tipo de contenido puede ser utilizado como tÃ©cnica de evasiÃ³n.
	

---

## ConclusiÃ³n

Se trata de implementar una capa determinista, explicable y fÃ¡cilmente auditada que reduce la superficie de ataque antes de que sistemas con IA procesen correos. Aunque no es infalible ni sustituye anÃ¡lisis mÃ¡s profundos, proporciona una barrera eficaz y auditable para mitigar prompt injection y otros intentos de manipulaciÃ³n vÃ­a correo. AdemÃ¡s de aportar un enfoque sensibilizador de cara al personal laboral y una constante vigilancia de estos sobre los correos recibidos.

Para seguir, proponemos:

- Validar umbrales con datos reales durante 2â€“4 semanas.
    
- Documentar un procedimiento de respuesta para correos crÃ­ticos detectados.
    

---
